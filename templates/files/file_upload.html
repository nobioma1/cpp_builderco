{% extends 'projects/_base.html' %}
{% load crispy_forms_tags %}

{% block page_title %}File Upload{% endblock %}

{% block project_content %}
    <div>
        <div class="d-flex justify-content-between align-items-center">
            <h3 class="m-0">Upload Project File</h3>
            <p class="lead fs-6 mb-0">({{ project.identifier }}) {{ project.name }}</p>
        </div>
        <hr class="w-100 border-secondary mt-2">
        <form method="post" class="w-100" enctype="multipart/form-data">
            {% csrf_token %}
            {{ form|crispy }}
            <div>
                <button type="submit" class="btn btn-primary d-block w-100 mb-3 btn-lg">Upload file
                </button>
            </div>
        </form>
    </div>
    <script>
        function handle_form(value) {
            $("#id_name").prop("disabled", value)
            $("#id_category").prop("disabled", value)
            var list = $("#div_id_existing_file")
            if (value) {
                $("#div_id_existing_file > label").addClass("requiredField")
                $("#div_id_existing_file > #id_existing_file").attr("required", "")
                list.show()
            } else {
                list.hide()
                $("#div_id_existing_file > label").removeClass("requiredField")
                $("#div_id_existing_file > #id_existing_file").removeAttr("required")
            }
        }

        $(document).ready(function () {
            var new_ver_el = $("#id_is_new_version")
            handle_form(new_ver_el.is(':checked'))
            new_ver_el.change(function () {
                if (this.checked) {
                    handle_form(true)
                } else {
                    handle_form(false)
                }
            });
        });
    </script>
{% endblock %}